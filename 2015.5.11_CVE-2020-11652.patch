diff --git a/salt/auth/__init__.py b/salt/auth/__init__.py
index e4396ff7e7..73203c3b10 100644
--- a/salt/auth/__init__.py
+++ b/salt/auth/__init__.py
@@ -30,6 +30,7 @@ import salt.config
 import salt.loader
 import salt.utils
 import salt.utils.minions
+import salt.utils.verify
 import salt.payload
 
 log = logging.getLogger(__name__)
@@ -147,6 +148,8 @@ class LoadAuth(object):
         hash_type = getattr(hashlib, self.opts.get('hash_type', 'md5'))
         tok = str(hash_type(os.urandom(512)).hexdigest())
         t_path = os.path.join(self.opts['token_dir'], tok)
+        if not salt.utils.verify.clean_path(self.opts['token_dir'], t_path):
+            return {}
         while os.path.isfile(t_path):
             tok = str(hash_type(os.urandom(512)).hexdigest())
             t_path = os.path.join(self.opts['token_dir'], tok)

diff --git a/salt/utils/verify.py b/salt/utils/verify.py
index f4d643adca..d6b6436a99 100644
--- a/salt/utils/verify.py
+++ b/salt/utils/verify.py
@@ -26,6 +26,7 @@ from salt.log import is_console_configured
 from salt.exceptions import SaltClientError
 import salt.defaults.exitcodes
 import salt.utils
+import salt.ext.six
 
 log = logging.getLogger(__name__)
 
@@ -451,23 +452,69 @@ def check_max_open_files(opts):
     log.log(level=level, msg=msg)
 
 
+def _realpath_darwin(path):
+    base = ''
+    for part in path.split(os.path.sep)[1:]:
+        if base != '':
+            if os.path.islink(os.path.sep.join([base, part])):
+                base = os.readlink(os.path.sep.join([base, part]))
+            else:
+                base = os.path.abspath(os.path.sep.join([base, part]))
+        else:
+            base = os.path.abspath(os.path.sep.join([base, part]))
+    return base
+
+
+def _realpath_windows(path):
+    base = ''
+    for part in path.split(os.path.sep):
+        if base != '':
+            try:
+                part = os.readlink(os.path.sep.join([base, part]))
+                base = os.path.abspath(part)
+            except OSError:
+                base = os.path.abspath(os.path.sep.join([base, part]))
+        else:
+            base = part
+    return base
+
+
+def _realpath(path):
+    '''
+    Cross platform realpath method. On Windows when python 3, this method
+    uses the os.readlink method to resolve any filesystem links. On Windows
+    when python 2, this method is a no-op. All other platforms and version use
+    os.path.realpath
+    '''
+    if salt.utils.is_darwin():
+        return _realpath_darwin(path)
+    elif salt.utils.is_windows():
+        if salt.ext.six.PY3:
+            return _realpath_windows(path)
+        else:
+            return path
+    return os.path.realpath(path)
+
+
 def clean_path(root, path, subdir=False):
     '''
     Accepts the root the path needs to be under and verifies that the path is
     under said root. Pass in subdir=True if the path can result in a
     subdirectory of the root instead of having to reside directly in the root
     '''
-    if not os.path.isabs(root):
+    real_root = _realpath(root)
+    if not os.path.isabs(real_root):
         return ''
     if not os.path.isabs(path):
         path = os.path.join(root, path)
     path = os.path.normpath(path)
+    real_path = _realpath(path)
     if subdir:
-        if path.startswith(root):
-            return path
+        if real_path.startswith(real_root):
+            return real_path
     else:
-        if os.path.dirname(path) == os.path.normpath(root):
-            return path
+        if os.path.dirname(real_path) == os.path.normpath(real_root):
+            return real_path
     return ''
 
 
diff --git a/salt/wheel/config.py b/salt/wheel/config.py
index 8964cd5b26..806de56ea2 100644
--- a/salt/wheel/config.py
+++ b/salt/wheel/config.py
@@ -13,6 +13,7 @@ import yaml
 
 # Import salt libs
 import salt.config
+import salt.utils.verify
 
 log = logging.getLogger(__name__)
 
@@ -80,6 +81,8 @@ def update_config(file_name, yaml_contents):
             os.makedirs(dir_path, 755)
 
         file_path = os.path.join(dir_path, file_name)
+        if not salt.utils.verify.clean_path(dir_path, file_path):
+            return 'Invalid path'
         with salt.utils.fopen(file_path, 'w') as fp_:
             fp_.write(yaml_out)
 
diff --git a/salt/wheel/file_roots.py b/salt/wheel/file_roots.py
index b7cf9c4882..0a1d99bf42 100644
--- a/salt/wheel/file_roots.py
+++ b/salt/wheel/file_roots.py
@@ -9,7 +9,7 @@ import os
 
 # Import salt libs
 import salt.utils
-
+import salt.utils.verify
 
 def find(path, saltenv='base', env=None):
     '''
@@ -30,6 +30,8 @@ def find(path, saltenv='base', env=None):
         return ret
     for root in __opts__['file_roots'][saltenv]:
         full = os.path.join(root, path)
+        if not salt.utils.verify.clean_path(root, full):
+            continue
         if os.path.isfile(full):
             # Add it to the dict
             with salt.utils.fopen(full, 'rb') as fp_:
@@ -137,7 +139,10 @@ def write(data, path, saltenv='base', index=0, env=None):
     if os.path.isabs(path):
         return ('The path passed in {0} is not relative to the environment '
                 '{1}').format(path, saltenv)
-    dest = os.path.join(__opts__['file_roots'][saltenv][index], path)
+    root = __opts__['file_roots'][saltenv][index]
+    dest = os.path.join(root, path)
+    if not salt.utils.verify.clean_path(root, dest, subdir=True):
+        return 'Invalid path: {}'.format(path)
     dest_dir = os.path.dirname(dest)
     if not os.path.isdir(dest_dir):
         os.makedirs(dest_dir)
